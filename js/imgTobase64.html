<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  
  <img  id="domImg" alt="" onclick="load()">
<span onclick="funDownload()">点击</span>
  <script>
    //  function ddd(){
    //    // 需要后台配置跨域
    //  console.log(22222)
    //  // 创建隐藏的可下载链接  
    //  // let  blob = 'http://pic.c-ctrip.com/VacationH5Pic/mice/wechat/ewm01.png';
    //  // var a = document.createElement('a');
    //  // a.style.display = 'none';
    //  // a.href = blob;       
    //  // a.download = 'QRcode.jpg';
    //  // document.body.appendChild(a);
    //  // a.click();
    //  // //移除元素
    //  // document.body.removeChild(a);
    //  //canvans下载
    //  let src = 'http://pic.c-ctrip.com/VacationH5Pic/mice/wechat/ewm01.png';
    //  var canvas = document.createElement('canvas');
    //  var img = document.createElement('img');
    //  img.onload = function(e) {
    //  canvas.width = img.width;
    //  canvas.height = img.height;
    //  var context = canvas.getContext('2d');
    //  context.drawImage(img, 0, 0, img.width, img.height);
    //  // window.navigator.msSaveBlob(canvas.msToBlob(),'image.jpg');
    //  // saveAs(imageDataUrl, '附件');
    //  canvas.getContext('2d').drawImage(img, 0, 0, img.width, img.height);
    //  canvas.toBlob((blob)=>{
    //  let link = document.createElement('a');
    //  link.href = window.URL.createObjectURL(blob);
    //  link.download = 'aaa';
    //  link.click();
    //  }, "image/jpeg");
    //  // context.toBlob(function(blob) {
    //  // console.log('blob :', blob);


    //  // let link = document.createElement('a');
    //  // link.href = window.URL.createObjectURL(blob);
    //  // link.download = 'aaa';
    //  // }, "image/jpeg");
    //  }
    //  img.setAttribute("crossOrigin",'Anonymous');
    //  img.src = src;
    //  }
    function funDownload () {
      let domImg = document.getElementById('domImg');
      domImg.setAttribute("crossOrigin",'Anonymous');
      domImg.setAttribute('src',"../src/38535acb07434e538fae14913ca53fba.jpg")  
      let filename = '22'
    // 创建隐藏的可下载链接
      var eleLink = document.createElement('a');
      eleLink.download = filename;
      eleLink.style.display = 'none';
      // 图片转base64地址
      var canvas = document.createElement('canvas');
      var context = canvas.getContext('2d');
      var width = domImg.naturalWidth;
      var height = domImg.naturalHeight;
      context.drawImage(domImg, 0, 0);
      // 如果是PNG图片，则canvas.toDataURL('image/png')
      eleLink.href = canvas.toDataURL('image/jpeg');
      // 触发点击
      document.body.appendChild(eleLink);
      eleLink.click();
      // 然后移除
      document.body.removeChild(eleLink);
    };
  </script>
</body>
</html>